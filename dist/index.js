var pe=Object.defineProperty;var a=(t,e)=>pe(t,"name",{value:e,configurable:!0});var vt=a(t=>{let e=t.split("/");return e[0]===""&&e.shift(),e},"splitPath"),It=a(t=>{let{groups:e,path:n}=me(t),r=vt(n);return ge(r,e)},"splitRoutingPath"),me=a(t=>{let e=[];return t=t.replace(/\{[^}]+\}/g,(n,r)=>{let s=`@${r}`;return e.push([s,n]),s}),{groups:e,path:t}},"extractGroupsFromPath"),ge=a((t,e)=>{for(let n=e.length-1;n>=0;n--){let[r]=e[n];for(let s=t.length-1;s>=0;s--)if(t[s].includes(r)){t[s]=t[s].replace(r,e[n][1]);break}}return t},"replaceGroupMarks"),ot={},wt=a(t=>{if(t==="*")return"*";let e=t.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);return e?(ot[t]||(e[2]?ot[t]=[t,e[1],new RegExp("^"+e[2]+"$")]:ot[t]=[t,e[1],!0]),ot[t]):null},"getPattern"),xt=a(t=>{let e=t.url.match(/^https?:\/\/[^/]+(\/[^?]*)/);return e?e[1]:""},"getPath"),jt=a(t=>{let e=t.indexOf("?",8);return e===-1?"":"?"+t.slice(e+1)},"getQueryStrings"),Nt=a(t=>{let e=xt(t);return e.length>1&&e[e.length-1]==="/"?e.slice(0,-1):e},"getPathNoStrict"),V=a((...t)=>{let e="",n=!1;for(let r of t)e[e.length-1]==="/"&&(e=e.slice(0,-1),n=!0),r[0]!=="/"&&(r=`/${r}`),r==="/"&&n?e=`${e}/`:r!=="/"&&(e=`${e}${r}`),r==="/"&&e===""&&(e="/");return e},"mergePath"),at=a(t=>{if(!t.match(/\:.+\?$/))return null;let e=t.split("/"),n=[],r="";return e.forEach(s=>{if(s!==""&&!/\:/.test(s))r+="/"+s;else if(/\:/.test(s))if(/\?/.test(s)){n.length===0&&r===""?n.push("/"):n.push(r);let i=s.replace("?","");r+="/"+i,n.push(r)}else r+="/"+s}),n.filter((s,i,o)=>o.indexOf(s)===i)},"checkOptionalParameter"),yt=a(t=>/[%+]/.test(t)?(t.indexOf("+")!==-1&&(t=t.replace(/\+/g," ")),/%/.test(t)?Q(t):t):t,"_decodeURI"),Dt=a((t,e,n)=>{let r;if(!n&&e&&!/[%+]/.test(e)){let o=t.indexOf(`?${e}`,8);for(o===-1&&(o=t.indexOf(`&${e}`,8));o!==-1;){let h=t.charCodeAt(o+e.length+1);if(h===61){let c=o+e.length+2,u=t.indexOf("&",c);return yt(t.slice(c,u===-1?void 0:u))}else if(h==38||isNaN(h))return"";o=t.indexOf(`&${e}`,o+1)}if(r=/[%+]/.test(t),!r)return}let s={};r??(r=/[%+]/.test(t));let i=t.indexOf("?",8);for(;i!==-1;){let o=t.indexOf("&",i+1),h=t.indexOf("=",i);h>o&&o!==-1&&(h=-1);let c=t.slice(i+1,h===-1?o===-1?void 0:o:h);if(r&&(c=yt(c)),i=o,c==="")continue;let u;h===-1?u="":(u=t.slice(h+1,o===-1?void 0:o),r&&(u=yt(u))),n?(s[c]&&Array.isArray(s[c])||(s[c]=[]),s[c].push(u)):s[c]??(s[c]=u)}return e?s[e]:s},"_getQueryParam"),Ft=Dt,Bt=a((t,e)=>Dt(t,e,!0),"getQueryParams"),Q=decodeURIComponent;var ye=/^[\w!#$%&'*.^`|~+-]+$/,ve=/^[ !#-:<-[\]-~]*$/,Wt=a((t,e)=>t.trim().split(";").reduce((r,s)=>{s=s.trim();let i=s.indexOf("=");if(i===-1)return r;let o=s.substring(0,i).trim();if(e&&e!==o||!ye.test(o))return r;let h=s.substring(i+1).trim();return h.startsWith('"')&&h.endsWith('"')&&(h=h.slice(1,-1)),ve.test(h)&&(r[o]=Q(h)),r},{}),"parse");var we=a((t,e,n={})=>{let r=`${t}=${e}`;return n&&typeof n.maxAge=="number"&&n.maxAge>=0&&(r+=`; Max-Age=${Math.floor(n.maxAge)}`),n.domain&&(r+=`; Domain=${n.domain}`),n.path&&(r+=`; Path=${n.path}`),n.expires&&(r+=`; Expires=${n.expires.toUTCString()}`),n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.sameSite&&(r+=`; SameSite=${n.sameSite}`),n.partitioned&&(r+="; Partitioned"),r},"_serialize"),Ut=a((t,e,n={})=>(e=encodeURIComponent(e),we(t,e,n)),"serialize");var qt={Stringify:1,BeforeStream:2,Stream:3},xe=a((t,e)=>{let n=new String(t);return n.isEscaped=!0,n.callbacks=e,n},"raw");var Et=a(async(t,e,n,r,s)=>{let i=t.callbacks;if(!i?.length)return Promise.resolve(t);s?s[0]+=t:s=[t];let o=Promise.all(i.map(h=>h({phase:e,buffer:s,context:r}))).then(h=>Promise.all(h.filter(Boolean).map(c=>Et(c,e,!1,r,s))).then(()=>s[0]));return n?xe(await o,i):o},"resolveCallback");var Gt=a(class{constructor(t,e){this.abortSubscribers=[],this.writable=t,this.writer=t.getWriter(),this.encoder=new TextEncoder;let n=e.getReader();this.responseReadable=new ReadableStream({async pull(r){let{done:s,value:i}=await n.read();s?r.close():r.enqueue(i)},cancel:()=>{this.abortSubscribers.forEach(r=>r())}})}async write(t){try{typeof t=="string"&&(t=this.encoder.encode(t)),await this.writer.write(t)}catch{}return this}async writeln(t){return await this.write(t+`
`),this}sleep(t){return new Promise(e=>setTimeout(e,t))}async close(){try{await this.writer.close()}catch{}}async pipe(t){this.writer.releaseLock(),await t.pipeTo(this.writable,{preventClose:!0}),this.writer=this.writable.getWriter()}async onAbort(t){this.abortSubscribers.push(t)}},"StreamingApi");var Kt=a((t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},"__accessCheck"),g=a((t,e,n)=>(Kt(t,e,"read from private field"),n?n.call(t):e.get(t)),"__privateGet"),Y=a((t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},"__privateAdd"),T=a((t,e,n,r)=>(Kt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),"__privateSet"),zt="text/plain; charset=UTF-8",Rt=a((t,e={})=>(Object.entries(e).forEach(([n,r])=>t.set(n,r)),t),"setHeaders"),rt,U,S,E,M,q,X=a(class{constructor(t,e){this.env={},this._var={},this.finalized=!1,this.error=void 0,Y(this,rt,200),Y(this,U,void 0),Y(this,S,void 0),Y(this,E,void 0),Y(this,M,void 0),Y(this,q,!0),this.renderer=n=>this.html(n),this.notFoundHandler=()=>new Response,this.render=(...n)=>this.renderer(...n),this.setRenderer=n=>{this.renderer=n},this.header=(n,r,s)=>{if(r===void 0){g(this,S)?g(this,S).delete(n):g(this,E)&&delete g(this,E)[n.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(n);return}s?.append?(g(this,S)||(T(this,q,!1),T(this,S,new Headers(g(this,E))),T(this,E,{})),g(this,S).append(n,r)):g(this,S)?g(this,S).set(n,r):(g(this,E)??T(this,E,{}),g(this,E)[n.toLowerCase()]=r),this.finalized&&(s?.append?this.res.headers.append(n,r):this.res.headers.set(n,r))},this.status=n=>{T(this,q,!1),T(this,rt,n)},this.set=(n,r)=>{this._var??(this._var={}),this._var[n]=r},this.get=n=>this._var?this._var[n]:void 0,this.newResponse=(n,r,s)=>{if(g(this,q)&&!s&&!r&&g(this,rt)===200)return new Response(n,{headers:g(this,E)});if(r&&typeof r!="number"){let o=Rt(new Headers(r.headers),g(this,E));return new Response(n,{headers:o,status:r.status})}let i=typeof r=="number"?r:g(this,rt);g(this,E)??T(this,E,{}),g(this,S)??T(this,S,new Headers),Rt(g(this,S),g(this,E)),g(this,M)&&(g(this,M).headers.forEach((o,h)=>{g(this,S)?.set(h,o)}),Rt(g(this,S),g(this,E))),s??(s={});for(let[o,h]of Object.entries(s))if(typeof h=="string")g(this,S).set(o,h);else{g(this,S).delete(o);for(let c of h)g(this,S).append(o,c)}return new Response(n,{status:i,headers:g(this,S)})},this.body=(n,r,s)=>typeof r=="number"?this.newResponse(n,r,s):this.newResponse(n,r),this.text=(n,r,s)=>{if(!g(this,E)){if(g(this,q)&&!s&&!r)return new Response(n);T(this,E,{})}return g(this,E)["content-type"]=zt,typeof r=="number"?this.newResponse(n,r,s):this.newResponse(n,r)},this.json=(n,r,s)=>{let i=JSON.stringify(n);return g(this,E)??T(this,E,{}),g(this,E)["content-type"]="application/json; charset=UTF-8",typeof r=="number"?this.newResponse(i,r,s):this.newResponse(i,r)},this.jsonT=(n,r,s)=>this.json(n,r,s),this.html=(n,r,s)=>(g(this,E)??T(this,E,{}),g(this,E)["content-type"]="text/html; charset=UTF-8",typeof n=="object"&&(n instanceof Promise||(n=n.toString()),n instanceof Promise)?n.then(i=>Et(i,qt.Stringify,!1,{})).then(i=>typeof r=="number"?this.newResponse(i,r,s):this.newResponse(i,r)):typeof r=="number"?this.newResponse(n,r,s):this.newResponse(n,r)),this.redirect=(n,r=302)=>(g(this,S)??T(this,S,new Headers),g(this,S).set("Location",n),this.newResponse(null,r)),this.streamText=(n,r,s)=>(s??(s={}),this.header("content-type",zt),this.header("x-content-type-options","nosniff"),this.header("transfer-encoding","chunked"),this.stream(n,r,s)),this.stream=(n,r,s)=>{let{readable:i,writable:o}=new TransformStream,h=new Gt(o,i);return n(h).finally(()=>h.close()),typeof r=="number"?this.newResponse(h.responseReadable,r,s):this.newResponse(h.responseReadable,r)},this.cookie=(n,r,s)=>{let i=Ut(n,r,s);this.header("set-cookie",i,{append:!0})},this.notFound=()=>this.notFoundHandler(this),this.req=t,e&&(T(this,U,e.executionCtx),this.env=e.env,e.notFoundHandler&&(this.notFoundHandler=e.notFoundHandler))}get event(){if(g(this,U)&&"respondWith"in g(this,U))return g(this,U);throw Error("This context has no FetchEvent")}get executionCtx(){if(g(this,U))return g(this,U);throw Error("This context has no ExecutionContext")}get res(){return T(this,q,!1),g(this,M)||T(this,M,new Response("404 Not Found",{status:404}))}set res(t){if(T(this,q,!1),g(this,M)&&t){g(this,M).headers.delete("content-type");for(let[e,n]of g(this,M).headers.entries())if(e==="set-cookie"){let r=g(this,M).headers.getSetCookie();t.headers.delete("set-cookie");for(let s of r)t.headers.append("set-cookie",s)}else t.headers.set(e,n)}T(this,M,t),this.finalized=!0}get var(){return{...this._var}}get runtime(){let t=globalThis;return t?.Deno!==void 0?"deno":t?.Bun!==void 0?"bun":typeof t?.WebSocketPair=="function"?"workerd":typeof t?.EdgeRuntime=="string"?"edge-light":t?.fastly!==void 0?"fastly":t?.__lagon__!==void 0?"lagon":t?.process?.release?.name==="node"?"node":"other"}},"Context");rt=new WeakMap;U=new WeakMap;S=new WeakMap;E=new WeakMap;M=new WeakMap;q=new WeakMap;var _t=a((t,e,n)=>(r,s)=>{let i=-1;return o(0);async function o(h){if(h<=i)throw new Error("next() called multiple times");i=h;let c,u=!1,p;if(t[h]?(p=t[h][0][0],r instanceof X&&(r.req.routeIndex=h)):p=h===t.length&&s||void 0,!p)r instanceof X&&r.finalized===!1&&n&&(c=await n(r));else try{c=await p(r,()=>o(h+1))}catch(y){if(y instanceof Error&&r instanceof X&&e)r.error=y,c=await e(y,r),u=!0;else throw y}return c&&(r.finalized===!1||u)&&(r.res=c),r}},"compose");var Vt=a(class extends Error{constructor(t=500,e){super(e?.message),this.res=e?.res,this.status=t}getResponse(){return this.res?this.res:new Response(this.message,{status:this.status})}},"HTTPException");var Qt=a(async(t,e={all:!1})=>{let n=t.headers.get("Content-Type");return Ee(n)?Re(t,e):{}},"parseBody");function Ee(t){return t===null?!1:t.startsWith("multipart/form-data")||t.startsWith("application/x-www-form-urlencoded")}a(Ee,"isFormDataContent");async function Re(t,e){let n=await t.formData();return n?_e(n,e):{}}a(Re,"parseFormData");function _e(t,e){let n={};return t.forEach((r,s)=>{e.all||s.endsWith("[]")?be(n,s,r):n[s]=r}),n}a(_e,"convertFormDataToBodyData");var be=a((t,e,n)=>{t[e]&&Se(t[e])?Pe(t[e],n):t[e]?Ae(t,e,n):t[e]=n},"handleParsingAllValues");function Se(t){return Array.isArray(t)}a(Se,"isArrayField");var Pe=a((t,e)=>{t.push(e)},"appendToExistingArray"),Ae=a((t,e,n)=>{t[e]=[t[e],n]},"convertToNewArray");var Jt=a((t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},"__accessCheck"),D=a((t,e,n)=>(Jt(t,e,"read from private field"),n?n.call(t):e.get(t)),"__privateGet"),Yt=a((t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},"__privateAdd"),Xt=a((t,e,n,r)=>(Jt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),"__privateSet"),nt,N,Zt=a(class{constructor(t,e="/",n=[[]]){Yt(this,nt,void 0),Yt(this,N,void 0),this.routeIndex=0,this.bodyCache={},this.cachedBody=r=>{let{bodyCache:s,raw:i}=this,o=s[r];return o||(s.arrayBuffer?(async()=>await new Response(s.arrayBuffer)[r]())():s[r]=i[r]())},this.raw=t,this.path=e,Xt(this,N,n),Xt(this,nt,{})}param(t){return t?this.getDecodedParam(t):this.getAllDecodedParams()}getDecodedParam(t){let e=D(this,N)[0][this.routeIndex][1][t],n=this.getParamValue(e);return n?/\%/.test(n)?Q(n):n:void 0}getAllDecodedParams(){let t={},e=Object.keys(D(this,N)[0][this.routeIndex][1]);for(let n of e){let r=this.getParamValue(D(this,N)[0][this.routeIndex][1][n]);r&&typeof r=="string"&&(t[n]=/\%/.test(r)?Q(r):r)}return t}getParamValue(t){return D(this,N)[1]?D(this,N)[1][t]:t}query(t){return Ft(this.url,t)}queries(t){return Bt(this.url,t)}header(t){if(t)return this.raw.headers.get(t.toLowerCase())??void 0;let e={};return this.raw.headers.forEach((n,r)=>{e[r]=n}),e}cookie(t){let e=this.raw.headers.get("Cookie");if(!e)return;let n=Wt(e);return t?n[t]:n}async parseBody(t){if(this.bodyCache.parsedBody)return this.bodyCache.parsedBody;let e=await Qt(this,t);return this.bodyCache.parsedBody=e,e}json(){return this.cachedBody("json")}text(){return this.cachedBody("text")}arrayBuffer(){return this.cachedBody("arrayBuffer")}blob(){return this.cachedBody("blob")}formData(){return this.cachedBody("formData")}addValidatedData(t,e){D(this,nt)[t]=e}valid(t){return D(this,nt)[t]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return D(this,N)[0].map(([[,t]])=>t)}get routePath(){return D(this,N)[0].map(([[,t]])=>t)[this.routeIndex].path}get headers(){return this.raw.headers}get body(){return this.raw.body}get bodyUsed(){return this.raw.bodyUsed}get integrity(){return this.raw.integrity}get keepalive(){return this.raw.keepalive}get referrer(){return this.raw.referrer}get signal(){return this.raw.signal}},"HonoRequest");nt=new WeakMap;N=new WeakMap;var b="ALL",te="all",ct=["get","post","put","delete","options","patch"],ht="Can not add a route since the matcher is already built.",ut=a(class extends Error{},"UnsupportedPathError");var re=a((t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},"__accessCheck"),lt=a((t,e,n)=>(re(t,e,"read from private field"),n?n.call(t):e.get(t)),"__privateGet"),Te=a((t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},"__privateAdd"),bt=a((t,e,n,r)=>(re(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),"__privateSet"),ke=Symbol("composedHandler");function Oe(){return class{}}a(Oe,"defineDynamicClass");var Le=a(t=>t.text("404 Not Found",404),"notFoundHandler"),ee=a((t,e)=>{if(t instanceof Vt)return t.getResponse();console.error(t);let n="Internal Server Error";return e.text(n,500)},"errorHandler"),F,ne=a(class extends Oe(){constructor(t={}){super(),this._basePath="/",Te(this,F,"/"),this.routes=[],this.notFoundHandler=Le,this.errorHandler=ee,this.onError=r=>(this.errorHandler=r,this),this.notFound=r=>(this.notFoundHandler=r,this),this.head=()=>(console.warn("`app.head()` is no longer used. `app.get()` implicitly handles the HEAD method."),this),this.handleEvent=r=>this.dispatch(r.request,r,void 0,r.request.method),this.fetch=(r,s,i)=>this.dispatch(r,i,s,r.method),this.request=(r,s,i,o)=>{if(r instanceof Request)return s!==void 0&&(r=new Request(r,s)),this.fetch(r,i,o);r=r.toString();let h=/^https?:\/\//.test(r)?r:`http://localhost${V("/",r)}`,c=new Request(h,s);return this.fetch(c,i,o)},this.fire=()=>{addEventListener("fetch",r=>{r.respondWith(this.dispatch(r.request,r,void 0,r.request.method))})},[...ct,te].map(r=>{this[r]=(s,...i)=>(typeof s=="string"?bt(this,F,s):this.addRoute(r,lt(this,F),s),i.map(o=>{typeof o!="string"&&this.addRoute(r,lt(this,F),o)}),this)}),this.on=(r,s,...i)=>{if(!r)return this;bt(this,F,s);for(let o of[r].flat())i.map(h=>{this.addRoute(o.toUpperCase(),lt(this,F),h)});return this},this.use=(r,...s)=>(typeof r=="string"?bt(this,F,r):s.unshift(r),s.map(i=>{this.addRoute(b,lt(this,F),i)}),this);let n=t.strict??!0;delete t.strict,Object.assign(this,t),this.getPath=n?t.getPath??xt:Nt}clone(){let t=new ne({router:this.router,getPath:this.getPath});return t.routes=this.routes,t}route(t,e){let n=this.basePath(t);return e?(e.routes.map(r=>{let s;e.errorHandler===ee?s=r.handler:(s=a(async(i,o)=>(await _t([],e.errorHandler)(i,()=>r.handler(i,o))).res,"handler"),s[ke]=r.handler),n.addRoute(r.method,r.path,s)}),this):n}basePath(t){let e=this.clone();return e._basePath=V(this._basePath,t),e}showRoutes(){this.routes.map(e=>{console.log(`\x1B[32m${e.method}\x1B[0m ${" ".repeat(8-e.method.length)} ${e.path}`)})}mount(t,e,n){let r=V(this._basePath,t),s=r==="/"?0:r.length,i=a(async(o,h)=>{let c;try{c=o.executionCtx}catch{}let u=n?n(o):[o.env,c],p=Array.isArray(u)?u:[u],y=jt(o.req.url),x=await e(new Request(new URL((o.req.path.slice(s)||"/")+y,o.req.url),o.req.raw),...p);if(x)return x;await h()},"handler");return this.addRoute(b,V(t,"*"),i),this}get routerName(){return this.matchRoute("GET","/"),this.router.name}addRoute(t,e,n){t=t.toUpperCase(),e=V(this._basePath,e);let r={path:e,method:t,handler:n};this.router.add(t,e,[n,r]),this.routes.push(r)}matchRoute(t,e){return this.router.match(t,e)}handleError(t,e){if(t instanceof Error)return this.errorHandler(t,e);throw t}dispatch(t,e,n,r){if(r==="HEAD")return(async()=>new Response(null,await this.dispatch(t,e,n,"GET")))();let s=this.getPath(t,{env:n}),i=this.matchRoute(r,s),o=new X(new Zt(t,s,i),{env:n,executionCtx:e,notFoundHandler:this.notFoundHandler});if(i[0].length===1){let c;try{c=i[0][0][0][0](o,async()=>{o.res=await this.notFoundHandler(o)})}catch(u){return this.handleError(u,o)}return c instanceof Promise?c.then(u=>u||(o.finalized?o.res:this.notFoundHandler(o))).catch(u=>this.handleError(u,o)):c}let h=_t(i[0],this.errorHandler,this.notFoundHandler);return(async()=>{try{let c=await h(o);if(!c.finalized)throw new Error("Context is not finalized. You may forget returning Response object or `await next()`");return c.res}catch(c){return this.handleError(c,o)}})()}},"_Hono"),se=ne;F=new WeakMap;var ft="[^/]+",st=".*",it="(?:|/.*)",J=Symbol();function He(t,e){return t.length===1?e.length===1?t<e?-1:1:-1:e.length===1||t===st||t===it?1:e===st||e===it?-1:t===ft?1:e===ft?-1:t.length===e.length?t<e?-1:1:e.length-t.length}a(He,"compareKey");var dt=a(class{constructor(){this.children={}}insert(t,e,n,r,s){if(t.length===0){if(this.index!==void 0)throw J;if(s)return;this.index=e;return}let[i,...o]=t,h=i==="*"?o.length===0?["","",st]:["","",ft]:i==="/*"?["","",it]:i.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),c;if(h){let u=h[1],p=h[2]||ft;if(u&&h[2]&&(p=p.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(p)))throw J;if(c=this.children[p],!c){if(Object.keys(this.children).some(y=>y!==st&&y!==it))throw J;if(s)return;c=this.children[p]=new dt,u!==""&&(c.varIndex=r.varIndex++)}!s&&u!==""&&n.push([u,c.varIndex])}else if(c=this.children[i],!c){if(Object.keys(this.children).some(u=>u.length>1&&u!==st&&u!==it))throw J;if(s)return;c=this.children[i]=new dt}c.insert(o,e,n,r,s)}buildRegExpStr(){let e=Object.keys(this.children).sort(He).map(n=>{let r=this.children[n];return(typeof r.varIndex=="number"?`(${n})@${r.varIndex}`:n)+r.buildRegExpStr()});return typeof this.index=="number"&&e.unshift(`#${this.index}`),e.length===0?"":e.length===1?e[0]:"(?:"+e.join("|")+")"}},"Node");var ie=a(class{constructor(){this.context={varIndex:0},this.root=new dt}insert(t,e,n){let r=[],s=[];for(let o=0;;){let h=!1;if(t=t.replace(/\{[^}]+\}/g,c=>{let u=`@\\${o}`;return s[o]=[u,c],o++,h=!0,u}),!h)break}let i=t.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let o=s.length-1;o>=0;o--){let[h]=s[o];for(let c=i.length-1;c>=0;c--)if(i[c].indexOf(h)!==-1){i[c]=i[c].replace(h,s[o][1]);break}}return this.root.insert(i,e,r,this.context,n),r}buildRegExp(){let t=this.root.buildRegExpStr();if(t==="")return[/^$/,[],[]];let e=0,n=[],r=[];return t=t.replace(/#(\d+)|@(\d+)|\.\*\$/g,(s,i,o)=>typeof i<"u"?(n[++e]=Number(i),"$()"):(typeof o<"u"&&(r[Number(o)]=++e),"")),[new RegExp(`^${t}`),n,r]}},"Trie");var St=[b,...ct].map(t=>t.toUpperCase()),oe=[],Ce=[/^$/,[],{}],Pt={};function ae(t){return Pt[t]??(Pt[t]=new RegExp(t==="*"?"":`^${t.replace(/\/\*/,"(?:|/.*)")}$`))}a(ae,"buildWildcardRegExp");function Me(){Pt={}}a(Me,"clearWildcardRegExpCache");function $e(t){let e=new ie,n=[];if(t.length===0)return Ce;let r=t.map(u=>[!/\*|\/:/.test(u[0]),...u]).sort(([u,p],[y,x])=>u?1:y?-1:p.length-x.length),s={};for(let u=0,p=-1,y=r.length;u<y;u++){let[x,O,R]=r[u];x?s[O]=[R.map(([_])=>[_,{}]),oe]:p++;let P;try{P=e.insert(O,p,x)}catch(_){throw _===J?new ut(O):_}x||(n[p]=R.map(([_,$])=>{let I={};for($-=1;$>=0;$--){let[k,B]=P[$];I[k]=B}return[_,I]}))}let[i,o,h]=e.buildRegExp();for(let u=0,p=n.length;u<p;u++)for(let y=0,x=n[u].length;y<x;y++){let O=n[u][y]?.[1];if(!O)continue;let R=Object.keys(O);for(let P=0,_=R.length;P<_;P++)O[R[P]]=h[O[R[P]]]}let c=[];for(let u in o)c[u]=n[o[u]];return[i,c,s]}a($e,"buildMatcherFromPreprocessedRoutes");function Z(t,e){if(t){for(let n of Object.keys(t).sort((r,s)=>s.length-r.length))if(ae(n).test(e))return[...t[n]]}}a(Z,"findMiddleware");var At=a(class{constructor(){this.name="RegExpRouter",this.middleware={[b]:{}},this.routes={[b]:{}}}add(t,e,n){var r;let{middleware:s,routes:i}=this;if(!s||!i)throw new Error(ht);St.indexOf(t)===-1&&St.push(t),s[t]||[s,i].forEach(c=>{c[t]={},Object.keys(c[b]).forEach(u=>{c[t][u]=[...c[b][u]]})}),e==="/*"&&(e="*");let o=(e.match(/\/:/g)||[]).length;if(/\*$/.test(e)){let c=ae(e);t===b?Object.keys(s).forEach(u=>{var p;(p=s[u])[e]||(p[e]=Z(s[u],e)||Z(s[b],e)||[])}):(r=s[t])[e]||(r[e]=Z(s[t],e)||Z(s[b],e)||[]),Object.keys(s).forEach(u=>{(t===b||t===u)&&Object.keys(s[u]).forEach(p=>{c.test(p)&&s[u][p].push([n,o])})}),Object.keys(i).forEach(u=>{(t===b||t===u)&&Object.keys(i[u]).forEach(p=>c.test(p)&&i[u][p].push([n,o]))});return}let h=at(e)||[e];for(let c=0,u=h.length;c<u;c++){let p=h[c];Object.keys(i).forEach(y=>{var x;(t===b||t===y)&&((x=i[y])[p]||(x[p]=[...Z(s[y],p)||Z(s[b],p)||[]]),i[y][p].push([n,o-u+c+1]))})}}match(t,e){Me();let n=this.buildAllMatchers();return this.match=(r,s)=>{let i=n[r],o=i[2][s];if(o)return o;let h=s.match(i[0]);if(!h)return[[],oe];let c=h.indexOf("",1);return[i[1][c],h]},this.match(t,e)}buildAllMatchers(){let t={};return St.forEach(e=>{t[e]=this.buildMatcher(e)||t[b]}),this.middleware=this.routes=void 0,t}buildMatcher(t){let e=[],n=t===b;return[this.middleware,this.routes].forEach(r=>{let s=r[t]?Object.keys(r[t]).map(i=>[i,r[t][i]]):[];s.length!==0?(n||(n=!0),e.push(...s)):t!==b&&e.push(...Object.keys(r[b]).map(i=>[i,r[b][i]]))}),n?$e(e):null}},"RegExpRouter");var Tt=a(class{constructor(t){this.name="SmartRouter",this.routers=[],this.routes=[],Object.assign(this,t)}add(t,e,n){if(!this.routes)throw new Error(ht);this.routes.push([t,e,n])}match(t,e){if(!this.routes)throw new Error("Fatal error");let{routers:n,routes:r}=this,s=n.length,i=0,o;for(;i<s;i++){let h=n[i];try{r.forEach(c=>{h.add(...c)}),o=h.match(t,e)}catch(c){if(c instanceof ut)continue;throw c}this.match=h.match.bind(h),this.routers=[h],this.routes=void 0;break}if(i===s)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,o}get activeRouter(){if(this.routes||this.routers.length!==1)throw new Error("No active router has been determined yet.");return this.routers[0]}},"SmartRouter");var kt=a(class{constructor(t,e,n){if(this.order=0,this.params={},this.children=n||{},this.methods=[],this.name="",t&&e){let r={};r[t]={handler:e,possibleKeys:[],score:0,name:this.name},this.methods=[r]}this.patterns=[]}insert(t,e,n){this.name=`${t} ${e}`,this.order=++this.order;let r=this,s=It(e),i=[],o=[];for(let u=0,p=s.length;u<p;u++){let y=s[u];if(Object.keys(r.children).includes(y)){o.push(...r.patterns),r=r.children[y];let O=wt(y);O&&i.push(O[1]);continue}r.children[y]=new kt;let x=wt(y);x&&(r.patterns.push(x),o.push(...r.patterns),i.push(x[1])),o.push(...r.patterns),r=r.children[y]}r.methods.length||(r.methods=[]);let h={},c={handler:n,possibleKeys:i.filter((u,p,y)=>y.indexOf(u)===p),name:this.name,score:this.order};return h[t]=c,r.methods.push(h),r}gHSets(t,e,n,r){let s=[];for(let i=0,o=t.methods.length;i<o;i++){let h=t.methods[i],c=h[e]||h[b],u={};c!==void 0&&(c.params={},c.possibleKeys.forEach(p=>{let y=u[c.name];c.params[p]=r[p]&&!y?r[p]:n[p]??r[p],u[c.name]=!0}),s.push(c))}return s}search(t,e){let n=[];this.params={};let s=[this],i=vt(e);for(let h=0,c=i.length;h<c;h++){let u=i[h],p=h===c-1,y=[];for(let x=0,O=s.length;x<O;x++){let R=s[x],P=R.children[u];P&&(P.params=R.params,p===!0?(P.children["*"]&&n.push(...this.gHSets(P.children["*"],t,R.params,{})),n.push(...this.gHSets(P,t,R.params,{}))):y.push(P));for(let _=0,$=R.patterns.length;_<$;_++){let I=R.patterns[_],k={...R.params};if(I==="*"){let W=R.children["*"];W&&(n.push(...this.gHSets(W,t,R.params,{})),y.push(W));continue}if(u==="")continue;let[B,z,j]=I,L=R.children[B],tt=i.slice(h).join("/");if(j instanceof RegExp&&j.test(tt)){k[z]=tt,n.push(...this.gHSets(L,t,R.params,k));continue}(j===!0||j instanceof RegExp&&j.test(u))&&typeof B=="string"&&(k[z]=u,p===!0?(n.push(...this.gHSets(L,t,k,R.params)),L.children["*"]&&n.push(...this.gHSets(L.children["*"],t,k,R.params))):(L.params=k,y.push(L)))}}s=y}return[n.sort((h,c)=>h.score-c.score).map(({handler:h,params:c})=>[h,c])]}},"Node");var Ot=a(class{constructor(){this.name="TrieRouter",this.node=new kt}add(t,e,n){let r=at(e);if(r){for(let s of r)this.node.insert(t,s,n);return}this.node.insert(t,e,n)}match(t,e){return this.node.search(t,e)}},"TrieRouter");var Lt=a(class extends se{constructor(t={}){super(t),this.router=t.router??new Tt({routers:[new At,new Ot]})}},"Hono");function Ht(){Ht=a(function(){return e},"_regeneratorRuntime");var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(f,l,d){f[l]=d.value},i=typeof Symbol=="function"?Symbol:{},o=i.iterator||"@@iterator",h=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(f,l,d){return Object.defineProperty(f,l,{value:d,enumerable:!0,configurable:!0,writable:!0}),f[l]}a(u,"define");try{u({},"")}catch{u=a(function(l,d,v){return l[d]=v},"define")}function p(f,l,d,v){var m=l&&l.prototype instanceof $?l:$,w=Object.create(m.prototype),A=new mt(v||[]);return s(w,"_invoke",{value:fe(f,d,A)}),w}a(p,"wrap");function y(f,l,d){try{return{type:"normal",arg:f.call(l,d)}}catch(v){return{type:"throw",arg:v}}}a(y,"tryCatch"),e.wrap=p;var x="suspendedStart",O="suspendedYield",R="executing",P="completed",_={};function $(){}a($,"Generator");function I(){}a(I,"GeneratorFunction");function k(){}a(k,"GeneratorFunctionPrototype");var B={};u(B,o,function(){return this});var z=Object.getPrototypeOf,j=z&&z(z(gt([])));j&&j!==n&&r.call(j,o)&&(B=j);var L=k.prototype=$.prototype=Object.create(B);function tt(f){["next","throw","return"].forEach(function(l){u(f,l,function(d){return this._invoke(l,d)})})}a(tt,"defineIteratorMethods");function W(f,l){function d(m,w,A,H){var C=y(f[m],f,w);if(C.type!=="throw"){var K=C.arg,et=K.value;return et&&typeof et=="object"&&r.call(et,"__await")?l.resolve(et.__await).then(function(G){d("next",G,A,H)},function(G){d("throw",G,A,H)}):l.resolve(et).then(function(G){K.value=G,A(K)},function(G){return d("throw",G,A,H)})}H(C.arg)}a(d,"invoke");var v;s(this,"_invoke",{value:function(m,w){function A(){return new l(function(H,C){d(m,w,H,C)})}return a(A,"callInvokeWithMethodAndArg"),v=v?v.then(A,A):A()}})}a(W,"AsyncIterator");function fe(f,l,d){var v=x;return function(m,w){if(v===R)throw new Error("Generator is already running");if(v===P){if(m==="throw")throw w;return{value:t,done:!0}}for(d.method=m,d.arg=w;;){var A=d.delegate;if(A){var H=$t(A,d);if(H){if(H===_)continue;return H}}if(d.method==="next")d.sent=d._sent=d.arg;else if(d.method==="throw"){if(v===x)throw v=P,d.arg;d.dispatchException(d.arg)}else d.method==="return"&&d.abrupt("return",d.arg);v=R;var C=y(f,l,d);if(C.type==="normal"){if(v=d.done?P:O,C.arg===_)continue;return{value:C.arg,done:d.done}}C.type==="throw"&&(v=P,d.method="throw",d.arg=C.arg)}}}a(fe,"makeInvokeMethod");function $t(f,l){var d=l.method,v=f.iterator[d];if(v===t)return l.delegate=null,d==="throw"&&f.iterator.return&&(l.method="return",l.arg=t,$t(f,l),l.method==="throw")||d!=="return"&&(l.method="throw",l.arg=new TypeError("The iterator does not provide a '"+d+"' method")),_;var m=y(v,f.iterator,l.arg);if(m.type==="throw")return l.method="throw",l.arg=m.arg,l.delegate=null,_;var w=m.arg;return w?w.done?(l[f.resultName]=w.value,l.next=f.nextLoc,l.method!=="return"&&(l.method="next",l.arg=t),l.delegate=null,_):w:(l.method="throw",l.arg=new TypeError("iterator result is not an object"),l.delegate=null,_)}a($t,"maybeInvokeDelegate");function de(f){var l={tryLoc:f[0]};1 in f&&(l.catchLoc=f[1]),2 in f&&(l.finallyLoc=f[2],l.afterLoc=f[3]),this.tryEntries.push(l)}a(de,"pushTryEntry");function pt(f){var l=f.completion||{};l.type="normal",delete l.arg,f.completion=l}a(pt,"resetTryEntry");function mt(f){this.tryEntries=[{tryLoc:"root"}],f.forEach(de,this),this.reset(!0)}a(mt,"Context");function gt(f){if(f||f===""){var l=f[o];if(l)return l.call(f);if(typeof f.next=="function")return f;if(!isNaN(f.length)){var d=-1,v=a(function m(){for(;++d<f.length;)if(r.call(f,d))return m.value=f[d],m.done=!1,m;return m.value=t,m.done=!0,m},"next");return v.next=v}}throw new TypeError(typeof f+" is not iterable")}return a(gt,"values"),I.prototype=k,s(L,"constructor",{value:k,configurable:!0}),s(k,"constructor",{value:I,configurable:!0}),I.displayName=u(k,c,"GeneratorFunction"),e.isGeneratorFunction=function(f){var l=typeof f=="function"&&f.constructor;return!!l&&(l===I||(l.displayName||l.name)==="GeneratorFunction")},e.mark=function(f){return Object.setPrototypeOf?Object.setPrototypeOf(f,k):(f.__proto__=k,u(f,c,"GeneratorFunction")),f.prototype=Object.create(L),f},e.awrap=function(f){return{__await:f}},tt(W.prototype),u(W.prototype,h,function(){return this}),e.AsyncIterator=W,e.async=function(f,l,d,v,m){m===void 0&&(m=Promise);var w=new W(p(f,l,d,v),m);return e.isGeneratorFunction(l)?w:w.next().then(function(A){return A.done?A.value:w.next()})},tt(L),u(L,c,"Generator"),u(L,o,function(){return this}),u(L,"toString",function(){return"[object Generator]"}),e.keys=function(f){var l=Object(f),d=[];for(var v in l)d.push(v);return d.reverse(),a(function m(){for(;d.length;){var w=d.pop();if(w in l)return m.value=w,m.done=!1,m}return m.done=!0,m},"next")},e.values=gt,mt.prototype={constructor:mt,reset:function(f){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(pt),!f)for(var l in this)l.charAt(0)==="t"&&r.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=t)},stop:function(){this.done=!0;var f=this.tryEntries[0].completion;if(f.type==="throw")throw f.arg;return this.rval},dispatchException:function(f){if(this.done)throw f;var l=this;function d(C,K){return w.type="throw",w.arg=f,l.next=C,K&&(l.method="next",l.arg=t),!!K}a(d,"handle");for(var v=this.tryEntries.length-1;v>=0;--v){var m=this.tryEntries[v],w=m.completion;if(m.tryLoc==="root")return d("end");if(m.tryLoc<=this.prev){var A=r.call(m,"catchLoc"),H=r.call(m,"finallyLoc");if(A&&H){if(this.prev<m.catchLoc)return d(m.catchLoc,!0);if(this.prev<m.finallyLoc)return d(m.finallyLoc)}else if(A){if(this.prev<m.catchLoc)return d(m.catchLoc,!0)}else{if(!H)throw new Error("try statement without catch or finally");if(this.prev<m.finallyLoc)return d(m.finallyLoc)}}}},abrupt:function(f,l){for(var d=this.tryEntries.length-1;d>=0;--d){var v=this.tryEntries[d];if(v.tryLoc<=this.prev&&r.call(v,"finallyLoc")&&this.prev<v.finallyLoc){var m=v;break}}m&&(f==="break"||f==="continue")&&m.tryLoc<=l&&l<=m.finallyLoc&&(m=null);var w=m?m.completion:{};return w.type=f,w.arg=l,m?(this.method="next",this.next=m.finallyLoc,_):this.complete(w)},complete:function(f,l){if(f.type==="throw")throw f.arg;return f.type==="break"||f.type==="continue"?this.next=f.arg:f.type==="return"?(this.rval=this.arg=f.arg,this.method="return",this.next="end"):f.type==="normal"&&l&&(this.next=l),_},finish:function(f){for(var l=this.tryEntries.length-1;l>=0;--l){var d=this.tryEntries[l];if(d.finallyLoc===f)return this.complete(d.completion,d.afterLoc),pt(d),_}},catch:function(f){for(var l=this.tryEntries.length-1;l>=0;--l){var d=this.tryEntries[l];if(d.tryLoc===f){var v=d.completion;if(v.type==="throw"){var m=v.arg;pt(d)}return m}}throw new Error("illegal catch attempt")},delegateYield:function(f,l,d){return this.delegate={iterator:gt(f),resultName:l,nextLoc:d},this.method==="next"&&(this.arg=t),_}},e}a(Ht,"_regeneratorRuntime");function ce(t,e,n,r,s,i,o){try{var h=t[i](o),c=h.value}catch(u){n(u);return}h.done?e(c):Promise.resolve(c).then(r,s)}a(ce,"asyncGeneratorStep");function Ie(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var i=t.apply(e,n);function o(c){ce(i,r,s,o,h,"next",c)}a(o,"_next");function h(c){ce(i,r,s,o,h,"throw",c)}a(h,"_throw"),o(void 0)})}}a(Ie,"_asyncToGenerator");function Ct(){return Ct=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ct.apply(this,arguments)}a(Ct,"_extends");var je="https://www2.deepl.com/jsonrpc",he=3;function Ne(t,e){var n,r;return t===void 0&&(t="auto"),e===void 0&&(e="en"),{jsonrpc:"2.0",method:"LMT_handle_texts",id:Math.floor(Math.random()*1e5+1e5)*1e3,params:{texts:[{text:"",requestAlternatives:he}],timestamp:0,splitting:"newlines",lang:{source_lang_user_selected:(n=t)==null?void 0:n.toUpperCase(),target_lang:(r=e)==null?void 0:r.toUpperCase()}}}}a(Ne,"buildRequestParams");function De(t){return(t||"").split("i").length-1}a(De,"countLetterI");function Fe(t){var e=new Date().getTime();return t!==0?e-e%(t+1)+(t+1):e}a(Fe,"getTimestamp");function Be(t){var e=Ne(t.source_lang,t.target_lang);e.params.texts=[{text:t.text,requestAlternatives:he}],e.params.timestamp=Fe(De(t.text));var n=JSON.stringify(e);return[0,3].includes((e.id+5)%29)||(e.id+3)%13===0?n=n.replace('"method":"','"method" : "'):n=n.replace('"method":"','"method": "'),n}a(Be,"buildRequestBody");function ue(t,e){return Mt.apply(this,arguments)}a(ue,"query");function Mt(){return Mt=Ie(Ht().mark(a(function t(e,n){var r,s,i,o,h,c;return Ht().wrap(a(function(p){for(;;)switch(p.prev=p.next){case 0:if(e!=null&&e.text){p.next=2;break}return p.abrupt("return",{code:404,message:"No Translate Text Found",data:null});case 2:return p.next=4,fetch((r=n?.proxyEndpoint)!=null?r:je,{headers:Ct({"Content-Type":"application/json; charset=utf-8"},n?.customHeader),method:"POST",body:Be(e)});case 4:if(s=p.sent,!s.ok){p.next=13;break}return p.next=8,s.json();case 8:return h=p.sent,c=h.result,p.abrupt("return",{code:200,message:"success",data:c==null||(i=c.texts)==null||(i=i[0])==null?void 0:i.text,source_lang:e?.source_lang||c?.lang||"auto",target_lang:e?.target_lang||"en",alternatives:(o=c.texts)==null||(o=o[0])==null||(o=o.alternatives)==null||o.map==null?void 0:o.map(function(y){return y.text})});case 13:return p.abrupt("return",{code:s.status,data:null,message:s.status===429?"Too many requests, please try again later.":"Unknown error."});case 14:case"end":return p.stop()}},"_callee$"),t)},"_callee"))),Mt.apply(this,arguments)}a(Mt,"_query");var le=new Lt;le.get("/",t=>t.redirect("/translate")).get("/translate",t=>t.text("Please use POST method :)")).post("/translate",async t=>{let e=await t.req.json().catch(()=>({})),n=await ue(e,{proxyEndpoint:"https://deepl-proxy-ivory.vercel.app/jsonrpc"});return t.json(n,n.code)});var Pn=le;export{Pn as default};
//# sourceMappingURL=index.js.map
